See "Programming with effects" http://www.cs.nott.ac.uk/~gmh/monads
